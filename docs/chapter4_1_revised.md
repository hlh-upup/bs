# 第4章 §4.1 审查报告与修订稿

> **文件说明**：本文件由盲审视角系统性评审原 `chapter4_thesis.md` 中的第4.1节，
> 输出结构化审查报告，并在"二、修订稿"部分提供经逐条修订后的完整4.1章节内容。
> 原文件保持不变，如需采纳本修订，将修订稿内容替换原文件中的4.1节即可。

---

# 一、审查报告

> 审查角色：硕士论文盲审专家 · 系统架构评审专家 · 软件工程方向论文评阅人

## 1. 总体评价

当前4.1节整体框架清晰，两域分治的架构设计思路具备较好的学术合理性，
层次划分符合工程实践逻辑，bs模型的定位描述完整。
但存在**三处高影响度缺陷**（图示缺失、模型流程图错误、内容重复）
及若干表达层面问题，现阶段整体评定为：**良好（需局部修改后可达优秀）**。

---

## 2. 结构性问题

**问题1：图4-1、图4-2、图4-3均以文字说明代替实际图形**

- 问题描述：三处图题后仅有一段括号内的文字描述（"图示说明：……"），
  全章没有任何实际的图形内容。论文规范要求图题所指向的位置必须存在对应图形；
  文字说明只能作为图题注释，不能替代图本身。
  在文稿阶段，若无法嵌入高质量位图，应以ASCII字符画作为占位图形。
- 影响程度：**高**
- 修改建议：在每个图题下方直接插入对应的ASCII结构图；
  删除括号内的纯文字"图示说明"段落。

**问题2：4.1.2.2模型流程图中VITS与Wav2Lip的连接关系错误**

- 问题描述：当前ASCII图中的连接路径为
  "文本 → VITS → 分叉 → Wav2Lip / SadTalker"，
  即将VITS的输出同时送入Wav2Lip和SadTalker两条分支。
  然而系统实际运行逻辑为两条**互斥**的独立路径：
  路径A（用户自录音频）：用户音频 → Wav2Lip → MP4；
  路径B（参考音频/TTS合成）：文本 → VITS → WAV → SadTalker → MP4。
  VITS与Wav2Lip在任何情况下不存在串联关系，当前图形属于逻辑性错误。
- 影响程度：**高**
- 修改建议：将4.1.2.2图形改为双路径并列布局，
  路径A与路径B各自独立展示，不共享起始节点。

**问题3：4.1.2.2与4.1.3之间存在内容重复**

- 问题描述：4.1.2.2"质量评估子系统"末段已列出五个评分维度
  （"口型同步、表情自然度、音频质量、跨模态一致性与综合质量"），
  4.1.3"职责界定"中的"质量感知"条目再次枚举相同的五个维度。
  两节均以"多模态特征提取"描述bs模型的工作方式，形成实质性重复。
- 影响程度：**高**
- 修改建议：4.1.2.2专注于子系统内部结构描述（特征提取模块、编码器、输出接口），
  将五维度枚举与详细的职责描述集中于4.1.3，
  4.1.2.2对输出结果以"结构化多维度评分"概括即可，不展开枚举。

**问题4：4.1.2节开头段落重复了4.1.1节的结论**

- 问题描述：4.1.2起首句"依据两域分治的架构设计思想，系统将功能模块划分为
  软件服务层与模型推理层两大层次"是对4.1.1末段内容的直接复述，
  缺乏从总体设计思想过渡到具体模块设计的推导过程。
- 影响程度：**中**
- 修改建议：4.1.2改为"本节从软件服务层与模型推理层两个维度，
  逐一阐述各功能模块的设计方案与技术实现，
  以呈现两域分治思想在模块级别的具体落地方式。"

---

## 3. 逻辑与模型贯通性评审（重点）

**bs模型是否真正成为架构核心？**

基本成立。bs模型在4.1.2.2（结构层）和4.1.3（职责层）两个层次均有描述，
在4.1.4数据流中也明确出现（"bs模型被自动触发"），
形成了结构—职责—数据流的三层呼应。
但由于4.1.2.2与4.1.3的内容重叠，读者会在两处读到相同的五维度描述，
导致bs模型的"核心性"被重复叙述所稀释，而非逐层深化。

**数据流是否闭环？**

闭环基本成立，三阶段（下行→推理→上行）逻辑清晰，
优化建议触发→用户调整→重新生成的回路在4.1.4末段有描述。
但图4-2缺失实际图形，使数据流的完整性只体现在文字层面，
视觉上无法形成"闭环"印象。

**是否存在"写了模型但架构未体现"的问题？**

不存在此问题。VITS、Wav2Lip、SadTalker、bs模型均在架构图（文字描述）、
分层结构、数据流三处均有呼应。
主要缺陷是图4-1/4-2/4-3的实际图形缺失及流程图的路径错误，
而非架构层面对模型的忽略。

---

## 4. 表达层面问题

**冗余表达：**

1. "整个调用过程对用户透明，无需额外操作"——
   "对用户透明"在工程语境下已包含"无需手动干预"的含义，
   "无需额外操作"为冗余补充，建议删去后半句。

2. "在服务启动阶段完成模型权重的一次性加载，
   此后每次推理请求到来时直接执行前向计算，
   避免重复加载模型权重带来的延迟开销"——
   第三分句"避免重复加载模型权重"与第一句"一次性加载"语义重叠，
   建议精简为"服务启动时完成模型权重的一次性预加载，
   后续推理请求直接调用已加载权重执行前向计算，避免逐次加载开销"。

**学术性不足语句：**

1. "运作链路" → 建议改为"处理流程"或"执行管线"。
2. "适合对唇形精度要求较高的场景" → 建议改为"适用于唇形同步精度要求较高的应用场景"。
3. "适合以VITS合成语音为输入的场景" → 建议改为"适用于以TTS合成语音驱动的数字人生成场景"。
4. "可操作的优化指引" → 建议改为"参数优化建议"。
5. 表4-1中"适合计算与IO混合型任务"/"适合跨模态质量评估" → 统一改为"适用于"。

**主观性措辞：**

1. "本系统的核心自研模型——bs多任务学习视频质量评估模型"——
   "核心"带有主观评价色彩，在学术写作中应避免自我标榜；
   建议改为"本文提出的bs多任务学习视频质量评估模型"。

2. "该方案与系统当前以个人使用为主要场景的定位相契合"——
   "当前"与"以…为主要场景的定位"叠加表述不够简洁；
   建议改为"该方案与系统面向个人用户的使用定位相契合"。

---

## 5. 修改优先级建议

**必须修改（影响论文合规性）：**

1. 为图4-1、图4-2、图4-3补充实际ASCII结构图，
   删除括号内的纯文字图示说明段落。
2. 修正4.1.2.2中模型流程图的路径逻辑（Wav2Lip与SadTalker为互斥双路径）。
3. 消除4.1.2.2与4.1.3之间的内容重复，
   明确两节的分工：4.1.2.2描述结构，4.1.3描述职责与调用流程。

**建议修改（提升学术质量）：**

4. 替换口语化/主观性措辞
   （"适合"→"适用于"，"运作链路"→"处理流程"，"核心自研"等）。
5. 精简冗余表达（"对用户透明，无需额外操作"等）。
6. 重写4.1.2节开头段落，避免直接重复4.1.1结论。

**可优化（锦上添花）：**

7. 4.1.4"结果上行路径"末句可明确"优化建议触发阈值"的存在依据，
   增加一句"各维度阈值由系统配置文件统一管理"，
   使质量闭环的触发机制更具工程可信度。
8. 表4-1中VITS的"选型依据"列可与正文中的VITS英文全称展开保持一致格式。

---
---

# 二、修订稿（4.1节完整内容）

> 以下为依据上述审查意见逐条修订后的第4.1节完整文本，
> 可直接替换原 `chapter4_thesis.md` 中的4.1节。
> 修订要点标注于各段落后的注释行（以 `<!-- 修订: … -->` 形式标记）。

---

## 4.1 系统架构设计

### 4.1.1 总体架构设计思想

数字人生成系统以"输入驱动生成、模型协同推理、自动化质量评估"为核心设计理念，旨在将数字人讲课视频的制作流程从依赖人工逐帧编辑的繁琐作业，转变为由系统自动完成生成与质量验证的闭环工作流。围绕这一目标，系统在架构层面确立了以下三项基本设计原则。

**关注点分离原则。** 系统将用户交互逻辑、业务调度逻辑与模型推理逻辑划分为相互独立的功能层次，各层次之间通过标准化接口协议传递数据，职责边界清晰，任意一层的内部变更均不影响其他层次的正常运行。这一原则保证了系统在面对模型迭代升级或界面功能扩展时具备良好的可维护性与可扩展性。

**异步解耦原则。** 视频生成推理属于计算密集型任务，单次生成耗时从数十秒至数分钟不等。为避免推理过程长期占用网络连接资源并阻塞前端界面响应，系统采用"请求立即返回、任务异步执行、状态定时轮询"的异步处理模式，将推理任务的执行生命周期与HTTP请求的生命周期彻底解耦，确保前端在推理期间的持续可用性。

**质量闭环原则。** 系统将生成质量评估作为完整生成流程中不可缺少的最终环节。每次视频生成完成后，系统自动触发质量评估模块，对输出视频进行多维度量化评分，并将评分结果与参数调整建议一并返回用户，形成"生成—评估—反馈—优化"的持续改进闭环，以数据驱动方式引导生成质量的迭代提升。

依据上述三项原则，系统整体采用**两域分治**的架构思路，将全部功能模块划分为**软件服务域**与**模型推理域**两大功能域。软件服务域负责用户交互与业务编排，涵盖前端交互层与后端服务层；模型推理域负责AI计算，涵盖视频生成子系统（VITS语音合成、Wav2Lip唇形渲染、SadTalker表情动画）与质量评估子系统（bs多任务视频质量评估模型）。两域之间通过后端服务层统一协调，构成"用户操作触发—软件层调度—模型层推理—结果评估回传"的完整处理流程。系统总体架构如图4-1所示。

图4-1　数字人生成系统总体架构图

```
┌──────────────────────────────────────────────────────────────────────┐
│                         数字人生成系统总体架构                          │
│                                                                      │
│ ┌────────────────────────────────────────────────────────────────┐  │
│ │                         软  件  服  务  域                       │  │
│ │                                                                │  │
│ │  ┌──────────────────────────────────────────────────────────┐  │  │
│ │  │                       前端交互层                          │  │  │
│ │  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐    │  │  │
│ │  │  │ 登录控制台│ │ 形象管理  │ │ 声音克隆  │ │ 视频配置  │    │  │  │
│ │  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘    │  │  │
│ │  │  ┌────────────────────────────────────────────────────┐  │  │  │
│ │  │  │               视频列表 / 五维评分结果展示              │  │  │  │
│ │  │  └────────────────────────────────────────────────────┘  │  │  │
│ │  │           Vue 3 · TypeScript · Pinia · Axios              │  │  │
│ │  └────────────────────────┬─────────────────────────────────┘  │  │
│ │            HTTP 请求 ↕ JSON 响应（RESTful，端口 5000）            │  │
│ │  ┌────────────────────────┴─────────────────────────────────┐  │  │
│ │  │                       后端服务层                          │  │  │
│ │  │  ┌───────────┐ ┌───────────┐ ┌──────────────────────┐    │  │  │
│ │  │  │ RESTful   │ │ 并发任务  │ │  三态任务状态机         │    │  │  │
│ │  │  │ 路由调度  │ │ 线程池   │ │  进行中/完成/失败        │    │  │  │
│ │  │  └───────────┘ └───────────┘ └──────────────────────┘    │  │  │
│ │  │       Python · Flask · Flask-CORS · ThreadPoolExecutor    │  │  │
│ │  └──────────────────────────────────────────────────────────┘  │  │
│ └──────────────────────────────┬─────────────────────────────────┘  │
│                      推理调用 ↓  │  ↑ 结果返回                        │
│ ┌──────────────────────────────┴─────────────────────────────────┐  │
│ │                         模  型  推  理  域                       │  │
│ │                                                                │  │
│ │  ┌─────────────────────────────────┐  ┌─────────────────────┐ │  │
│ │  │         视频生成子系统             │  │    质量评估子系统     │ │  │
│ │  │                                 │  │     （bs 模型）      │ │  │
│ │  │  路径A: 用户音频 → Wav2Lip       │  │  多模态特征提取       │ │  │
│ │  │               唇形同步渲染        │  │  Transformer 编码    │ │  │
│ │  │  路径B: 文本 → VITS → WAV        │  │  五维评分输出         │ │  │
│ │  │         WAV → SadTalker          │  │                     │ │  │
│ │  │               表情动画渲染        │  │                     │ │  │
│ │  │               ↓ MP4 ────────────────→                     │ │  │
│ │  └─────────────────────────────────┘  └─────────────────────┘ │  │
│ └────────────────────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────────────────┘
```

---

### 4.1.2 分层结构设计

本节从软件服务层与模型推理层两个维度，逐一阐述各功能模块的设计方案与技术实现，以呈现两域分治思想在模块级别的具体落地方式。

#### 4.1.2.1 软件服务层

软件服务层由前端交互层与后端服务层上下两层构成，负责系统与用户之间的全部交互逻辑，以及面向模型推理域的任务调度与结果管理。其层次结构如下所示：

```
┌────────────────────────────────────────────────────────────┐
│                         软件服务层                           │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐  │
│  │                      前端交互层                        │  │
│  │                                                      │  │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌──────────┐   │  │
│  │  │ 登录/   │ │ 数字人  │ │  声音   │ │  视频    │   │  │
│  │  │ 控制台  │ │ 形象管理│ │  克隆   │ │  配置    │   │  │
│  │  └─────────┘ └─────────┘ └─────────┘ └──────────┘   │  │
│  │  ┌─────────┐ ┌─────────────────────────────────────┐ │  │
│  │  │ 高级配置│ │       视频列表 / 评分结果展示           │ │  │
│  │  └─────────┘ └─────────────────────────────────────┘ │  │
│  │        Vue 3 · TypeScript · Pinia · Axios             │  │
│  └──────────────────────────┬───────────────────────────┘  │
│              HTTP 请求 ↕ JSON 响应（RESTful，端口 5000）      │
│  ┌──────────────────────────┴───────────────────────────┐  │
│  │                      后端服务层                        │  │
│  │                                                      │  │
│  │  ┌──────────┐ ┌──────────┐ ┌───────────────────────┐ │  │
│  │  │ RESTful  │ │ 并发任务 │ │    三态任务状态机        │ │  │
│  │  │ 路由调度 │ │  线程池  │ │ 进行中 / 完成 / 失败    │ │  │
│  │  └──────────┘ └──────────┘ └───────────────────────┘ │  │
│  │  ┌────────────────────┐ ┌─────────────────────────┐  │  │
│  │  │   用户目录管理      │ │   异常捕获 / 响应封装     │  │  │
│  │  └────────────────────┘ └─────────────────────────┘  │  │
│  │        Python · Flask · Flask-CORS · ThreadPool       │  │
│  └──────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────┘
```

**前端交互层**（Frontend Interaction Layer）承担系统与终端用户之间的全部视觉交互职责，覆盖用户登录认证、数字人形象上传与管理、参考声音录制与克隆配置、讲稿文本输入与编辑、视频生成的触发与进度监控，以及历史视频与质量评分的浏览查阅等核心交互场景。前端以组件化视图结构组织功能页面，通过统一封装的HTTP客户端服务模块与后端服务层通信，自身不承担业务逻辑判断或模型调用职责，保证了交互层的轻量化与独立可替换性。

**后端服务层**（Backend Service Layer）是系统的核心控制与调度中枢，以RESTful风格的HTTP服务接口对外提供统一的服务入口。该层负责接收并解析前端请求、维护用户数据目录、管理异步推理任务的生命周期，并以并发任务队列的形式协调多个推理模块的有序执行。通过引入三态任务状态机（"进行中"、"已完成"、"失败"），后端向前端提供可轮询的推理进度反馈，实现了推理任务执行生命周期与HTTP请求生命周期的彻底解耦。

#### 4.1.2.2 模型推理层

模型推理层承载系统的全部AI计算能力，内部划分为**视频生成子系统**与**质量评估子系统**两个功能子系统。二者在执行时序上串联：视频生成子系统负责将文本与人脸图像合成为数字人说话视频，质量评估子系统随后对生成视频进行多维度自动化评分，并将结构化评分结果返回软件服务层。其内部结构如下所示：

```
┌─────────────────────────────────────────────────────────────────┐
│                            模型推理层                              │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                       视频生成子系统                       │   │
│  │                                                         │   │
│  │    路径 A（用户自录音频）         路径 B（参考音频/TTS合成）  │   │
│  │   ┌──────────────────────┐   ┌──────────────────────┐  │   │
│  │   │  用户音频              │   │  讲稿文本              │  │   │
│  │   │       ↓               │   │       ↓               │  │   │
│  │   │  Wav2Lip              │   │  VITS 语音合成          │  │   │
│  │   │  唇形同步渲染           │   │  （文本 → WAV）        │  │   │
│  │   │       ↓               │   │       ↓               │  │   │
│  │   │  MP4 视频文件          │   │  SadTalker            │  │   │
│  │   └─────────┬─────────────┘   │  表情动画渲染           │  │   │
│  │             │                 │       ↓               │  │   │
│  │             │                 │  MP4 视频文件          │  │   │
│  │             │                 └──────────┬────────────┘  │   │
│  └─────────────┼────────────────────────────┼───────────────┘   │
│                │  MP4 视频（两路径汇合输出）  │                    │
│                └──────────────┬─────────────┘                   │
│                               ↓                                  │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    质量评估子系统（bs 模型）                 │   │
│  │                                                         │   │
│  │  多模态特征并行提取                                        │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌────────┐ ┌────────┐  │   │
│  │  │ 视觉深度特征 │ │ 音频语义特征 │ │ 关键点 │ │ AU特征 │  │   │
│  │  └──────┬──────┘ └──────┬──────┘ └───┬────┘ └───┬────┘  │   │
│  │         └───────────────┴────────────┴───────────┘       │   │
│  │                               ↓                          │   │
│  │                 Transformer 跨模态编码器                   │   │
│  │                               ↓                          │   │
│  │  五维评分输出：口型同步 / 表情自然度 / 音频质量 /             │   │
│  │               跨模态一致性 / 综合质量  →  JSON              │   │
│  └─────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

**视频生成子系统**集成三个协同工作的深度学习模型，按照音频来源形成两条互斥的串行处理路径。**VITS语音合成模型**（Variational Inference with adversarial learning for end-to-end Text-to-Speech）接收讲稿文本作为输入，输出自然语音WAV音频文件，支持基于参考音频的声音克隆以还原目标说话人音色。**Wav2Lip唇形同步渲染模型**接收音频文件与参考人脸图像，采用音视频联合判别器训练策略，生成唇形与音频高度同步的数字人视频，适用于唇形同步精度要求较高的应用场景。**SadTalker表情动画渲染模型**以三维面部系数（3DMM）对面部动态进行建模，将音频特征映射为表情系数与姿态系数，经人脸渲染网络输出具有自然表情与头部姿态变化的数字人视频，适用于以TTS合成语音驱动的数字人生成场景。系统依据用户提供的音频配置自动路由：若存在用户自录音频，则进入Wav2Lip处理路径（路径A）；否则进入VITS→SadTalker处理路径（路径B）。

**质量评估子系统**集成了本文提出的bs多任务学习视频质量评估模型。该模型接收生成视频文件，通过视觉深度特征、音频语义特征、面部关键点特征与面部动作单元特征的并行提取，经跨模态Transformer编码器对多模态时序特征进行联合建模，输出结构化的多维度量化评分，为系统质量反馈闭环提供数据支撑。bs模型的完整功能定位与调用机制详见4.1.3节。

系统各功能域的技术选型如表4-1所示。

**表4-1　系统技术选型说明**

| 功能域 | 组件 | 技术选型 | 选型依据 |
|---|---|---|---|
| 软件服务域 | 前端框架 | Vue 3 + TypeScript | 渐进式框架，Composition API提升逻辑复用性；TypeScript增强类型安全 |
| 软件服务域 | 前端状态与路由 | Pinia + Vue Router | 轻量级全局状态管理；多视图路由支持 |
| 软件服务域 | 前端网络通信 | Axios（含拦截器封装） | 支持超长超时配置；统一请求/响应日志；支持Base64文件内联传输 |
| 软件服务域 | 后端服务框架 | Flask + Flask-CORS | 轻量级Python Web框架，低耦合，易于集成推理模型；CORS支持前后端分离部署 |
| 软件服务域 | 并发任务管理 | ThreadPoolExecutor | 适用于计算密集与IO混合型任务；并发数可配置，避免长时推理阻塞主服务线程 |
| 模型推理域 | 语音合成 | VITS | 端到端TTS架构，音质自然，支持参考音频声音克隆 |
| 模型推理域 | 唇形同步渲染 | Wav2Lip | 音视频联合判别训练，唇形同步精度高，支持任意人脸图像输入 |
| 模型推理域 | 表情动画渲染 | SadTalker | 基于3DMM三维面部系数驱动，头部姿态与表情动画自然 |
| 模型推理域 | 视觉特征提取 | py-feat（RetinaFace + ResNet-101） | 集成人脸检测、关键点定位、AU识别与深层视觉特征提取的一体化工具链 |
| 模型推理域 | 音频特征提取 | HuBERT | 自监督大规模预训练，语音语义表征能力强，适用于跨模态质量评估 |
| 模型推理域 | 关键点检测 | MediaPipe Face Mesh | 实时提取468个三维面部关键点，眼部与唇部区域覆盖完整 |
| 模型推理域 | 质量评估框架 | PyTorch + Transformer | 动态图机制便于模型部署；多头注意力机制建模时序与跨模态依赖 |

---

### 4.1.3 bs模型在系统中的位置与职责

在系统的两域架构中，bs模型隶属于模型推理层的质量评估子系统，位于整个数字人生成管线的末端，是生成结果到达前端用户之前经历的最后一道处理环节。

**位置定位。** bs模型在模型推理层内与视频生成子系统串联，执行时序上严格置于VITS、Wav2Lip、SadTalker三个生成模型之后，构成生成管线的质量验证节点。bs模型由后端服务层在视频渲染任务完成后自动触发调用，其输入为视频生成子系统写出的MP4视频文件，输出为结构化的多维度质量评分数据，二者之间通过共享用户任务目录实现数据传递。

**职责界定。** bs模型在系统中承担三项核心职责：其一，**质量感知**，接收生成视频文件，通过多模态特征提取与跨模态联合评估，从口型同步、表情自然度、音频质量、跨模态一致性与综合质量五个维度输出量化评分；其二，**结果持久化**，将评分结果以结构化JSON格式写入用户任务目录，与视频文件并列存储，供后续检索与前端展示调用；其三，**反馈驱动**，评分结果经由后端服务层随视频数据一并下发前端，前端依据各维度分值生成差异化的参数优化建议，形成数据驱动的生成质量改进闭环。

**调用流程。** 后端服务层在接收到视频生成子系统任务完成的通知后，向质量评估子系统（bs模型）发起调用，传入已写出的视频文件路径；bs模型依次执行视频解码、多模态特征提取与Transformer前向推理，生成五维评分字典；后端将评分数据与视频文件路径信息整合，在前端发起视频拉取请求时一并响应，完成质量信息的完整闭环传递。整个调用过程对用户透明，无需手动干预。

---

### 4.1.4 系统数据流转路径

系统的数据流转路径构成一条从用户输入到质量反馈的完整闭合链路，可划分为**请求下行路径**、**推理处理路径**与**结果上行路径**三个阶段，如图4-2所示。

图4-2　数字人生成系统数据流转路径示意图

```
                        用户（前端操作）
                               │
                               ▼
              ╔════════════════════════════════════════╗
              ║           第一阶段：请求下行路径           ║
              ║                                        ║
              ║  前端封装 HTTP 请求                      ║
              ║  （文本 / 图像 / 音频 / 参数配置）         ║
              ║              ↓                         ║
              ║  后端接收 → 解析参数 → 初始化任务目录      ║
              ║  → 异步路由，立即返回任务标识（不阻塞）      ║
              ╚══════════════════╤═════════════════════╝
                                 │
                        ┌────────┴─────────┐
                        │   音频来源判断     │
                        └────┬────────┬────┘
               用户自录音频   │        │  参考音频 / 无音频
                             ↓        ↓
                          Wav2Lip   VITS 语音合成
                         唇形同步渲染  WAV → SadTalker
                             │         表情动画渲染
                             └────┬─────┘
                                  ↓
              ╔════════════════════════════════════════╗
              ║           第二阶段：推理处理路径           ║
              ║                                        ║
              ║  MP4 视频写入用户任务目录                 ║
              ║              ↓ 自动触发                  ║
              ║         bs 质量评估模型                   ║
              ║  多模态特征提取 → Transformer 编码         ║
              ║      → 五维评分 JSON 写入任务目录          ║
              ╚══════════════════╤═════════════════════╝
                                 │
                                 ▼
              ╔════════════════════════════════════════╗
              ║           第三阶段：结果上行路径           ║
              ║                                        ║
              ║  任务状态更新 → "已完成"                   ║
              ║  前端定时轮询 → 检测完成信号               ║
              ║  拉取：MP4 视频文件 + 五维评分 JSON         ║
              ║  渲染：视频播放器 + 评分卡片                ║
              ║  低分维度 → 触发参数优化建议                ║
              ╚══════════════════╤═════════════════════╝
                                 │
                        用户调整参数配置
                                 │
                                 ▼
                        重新触发视频生成
                    （构成质量改进闭环回路）
```


**请求下行路径。** 用户在前端完成数字人形象配置、声音克隆配置与讲稿文本输入后，触发视频生成请求。前端将用户输入数据（包括文本内容、人脸图像、音频文件及模型参数配置）封装为标准化HTTP请求，发送至后端服务层。后端完成请求解析与用户任务目录初始化后，依据用户目录中音频文件的存在状态执行推理路径路由——若存在用户自录音频，则路由至Wav2Lip渲染链路（路径A）；若存在参考音频，则路由至VITS语音合成加SadTalker表情渲染链路（路径B）——并将生成任务提交至异步执行队列，立即向前端返回任务标识，不阻塞请求线程。

**推理处理路径。** 生成任务在后端线程池中异步执行，依次经历语音合成与视频渲染两个子阶段：语音合成阶段（路径B）将文本转换为自然语音，输出WAV格式音频文件；视频渲染阶段将音频与人脸图像融合，输出具有唇形同步与面部表情的数字人MP4视频文件。视频文件写入用户任务目录后，bs模型被自动触发，对视频执行多模态特征提取与质量评分推理，将五维评分数据以JSON格式写入同一任务目录，与视频文件并列存储。

**结果上行路径。** 推理任务全部完成后，后端将任务状态标识更新为"已完成"。前端通过定时轮询状态接口检测到完成信号后，发起视频文件与评分数据的拉取请求；后端从用户任务目录读取相应文件并封装响应返回前端。前端完成视频播放界面与五维评分卡片的渲染，向用户呈现完整的生成结果与质量报告。若某一维度评分低于预设阈值，系统自动展示对应的参数优化建议，引导用户调整配置后重新触发生成，构成完整的质量改进闭环。

---

### 4.1.5 系统部署架构

本系统采用单机一体化部署方案，将前端服务、后端服务及全部推理模型部署于同一台配备高性能GPU的工作站之上。该方案与系统面向个人用户的使用定位相契合，在减少跨网络通信延迟的同时，简化了多组件协同部署的配置复杂度，并使所有推理模型能够充分共享单节点GPU的计算资源。

在服务端口分配上，前端应用服务监听本地5173端口，后端RESTful API服务监听5000端口，两者通过本机回环网络（localhost）进行HTTP通信，无需穿越外部网络路由。各推理模型以Python进程形式常驻于后端服务的执行空间内，服务启动时完成模型权重的一次性预加载，后续推理请求直接调用已加载权重执行前向计算，避免逐次加载开销。

在存储结构上，系统以本地文件系统为各模块之间的数据共享介质。后端服务为每位用户维护独立的任务目录，该目录作为推理链路各阶段的数据交换节点，同时也是前端拉取生成结果的数据来源。用户的参考图像、音频文件、生成视频及质量评分均以文件形式持久化于对应目录下，各推理模块通过读写共享目录中的文件完成数据流转，实现了模块间数据耦合的最小化。系统部署架构如图4-3所示。

图4-3　数字人生成系统部署架构示意图

```
┌─────────────────────────────────────────────────────────────────┐
│                       GPU 工作站（单机部署）                        │
│                                                                 │
│  ┌──────────────────────┐             ┌──────────────────────┐  │
│  │      前端应用区         │             │       后端应用区       │  │
│  │                      │◄── HTTP ───►│                      │  │
│  │  Vue 3 前端服务        │  (localhost) │  Flask 后端服务       │  │
│  │  监听端口 5173          │             │  监听端口 5000         │  │
│  └──────────────────────┘             │                      │  │
│                                       │  ┌──────────────────┐ │  │
│                                       │  │   视频生成子系统   │ │  │
│                                       │  │                  │ │  │
│                                       │  │  VITS 语音合成    │ │  │
│                                       │  │  Wav2Lip 渲染     │ │  │
│                                       │  │  SadTalker 渲染   │ │  │
│                                       │  └────────┬─────────┘ │  │
│                                       │           │ MP4        │  │
│                                       │  ┌────────▼─────────┐ │  │
│                                       │  │   质量评估子系统   │ │  │
│                                       │  │    （bs 模型）    │ │  │
│                                       │  └────────┬─────────┘ │  │
│                                       └───────────│────────────┘  │
│                                                   │               │
│                    ┌──────────────────────────────▼─────────┐    │
│                    │        用户任务目录（本地文件系统）          │    │
│                    │  参考图像 │ WAV音频 │ MP4视频 │ 评分JSON │    │
│                    └────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
```

